### 介绍

> 这个项目背景其实有两年，从我大一时，这个项目开始是由当时大二学长来领导的，此时我没有加入社团。然后从大二上半学期开始，我加入社团，开始和另一位同学慢慢接手这个项目。
>
> 在当时我们学校企业微信上会有一个健康打卡问卷，然后所有教职工每天去填报。之后我们会去在系统里面不断调用定时任务，然后同步到数据库里面。接下来，由各个校领导去调用导出excel的功能，去评判，因为这个基于当时形势也算工作内容。



### 关于亮点

> 关于项目上，没有采用什么很新的技术。但是我在开发中遇到了一些相关的难点........................



### 难点

> 在我接手的过程中，遇到过这几次问题难点。
>
> 首先是权限的问题。首先人物角色上，有学生、志愿者、辅导员、老师、领导、职工这几类人物。
>
> 然后范围上，分学院和班级。比如辅导员可以看属于自己院的学生，领导也是，然而志愿者是可以看对应班级的。然后一开始是这样设计的，以学院为划分单位，每个人对应院。这就导致一些问题，比如一旦加了新领导，必须手动在表里去加对应的院。还有辅导员也可能是学院的领导。
>
> 后来我进行了优化，用了市面上主流的RBAC模型，比如计算机学院辅导员对应计算机学院辅导员角色和自动化学院领导角色，然后去赋予对应的权限，避免了多次的查表，之前每查一次会延迟五秒钟。
>
> 然后是定时任务的缺陷，为了开发方便，使用的spring自带的scheduled。但是缺点渐渐暴露出来，主要就是不执行，而且任务失败没有报警机制。后来就改为了使用linux的crontab。
>
> 哦，对，还有一个就是scheduled的坑，本来是凑合用的，但是机器老是报负载太高，后来排查发现创建了大量的定时任务线程，原因是没有配置相关的线程池，导致每次执行定时任务都会重新创建一个线程来执行，直到达到oom才发现问题。

