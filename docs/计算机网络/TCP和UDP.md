### TCP和UDP的区别

> 1. TCP需要先建立连接，UDP是无连接的
> 2. TCP保证可靠传输，UDP尽最大努力交付
> 3. TCP面向字节流，UDP面向报文
> 4. TCP有拥塞控制，UDP没有，数据生成速率只跟网络状态有关
> 5. 每一条TCP连接只能是点到点的；而UDP支持一对一，一对多，多对一和多对多的交互通信



### TCP三次握手

>1. 客户端向服务端发送一个SYN
>2. 服务端接收到SYN后，给客户端发送一个SYN_ACK
>3. 客户端接收到SYN_ACK后，再给服务端发送一个ACK
>
>当然，问题不会问的这么简单，有些面试官会问，为什么不能两次握手？
>
>首先少了三次握手，就不能保证可靠连接的建立，第一次服务端确认了客户端的传输能力，第二次客户端确认了服务端的接收能力和发送能力，第三次服务端确认了客户端的接收能力。三次功能都不一样。



### TCP四次挥手

> 1. 客户端向服务端发送FIN
> 2. 服务端接收FIN后，向客户端发送ACK，表示我接收到了断开连接的请求，客户端你可以不发数据了，不过服务端这边可能还有数据正在处理
> 3. 服务端处理完所有数据后，向客户端发送FIN，表示服务端现在可以断开连接
> 4. 客户端收到服务端的FIN，向服务端发送ACK，表示客户端也会断开连接了
>
> 同理，无情追问：为什么不能三次挥手
>
> 这边我是这么理解的，因为第一次和第四次都是确认，所以如果压缩的话，只能将二三次挥手合并。第二次挥手主要是为了让客户端知道服务端这边知道了你要断开连接了，但是手头上还有数据没处理完。处理完之后才会发第三次断开请求。如果合并，那么等数据处理完之后才理客户端，会导致客户端发出第一个请求后，收不到信息，以为自己没发出去信息，就会进行TCP重发，浪费资源。



### SYN泛洪攻击

> syn洪泛攻击是Dos攻击的一种，服务器端的资源分配是在二次握手时分配的，而客户端的资源是在完成三次握手时分配的，所以服务器容易受到SYN洪泛攻击，SYN攻击就是Client在短时间内伪造大量不存在的IP地址，并向Server不断地发送SYN包，Server则回复SYN+ACK确认包，并等待Client确认回复ACK,而这些大量的IP是不存在的，并不会向服务端发送ack确认包，所以会大量的占领半连接队列资源，导致正常的SYN请求因为队列满而被丢弃，从而引起网络拥塞甚至系统瘫痪。
>
> 
>
> 主要三种方式防御:
>
> 1、降低SYN timeout时间，使得主机尽快释放半连接的占用
> 2、采用SYN cookie设置，如果短时间内连续收到某个IP的重复SYN请求，则认为受到了该IP的攻击，丢弃来自该IP的后续请求报文
> 3、在网关处设置过滤，拒绝将一个源IP地址不属于其来源子网的包进行更远的路由