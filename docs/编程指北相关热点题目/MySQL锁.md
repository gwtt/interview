### 1.表级锁和⾏级锁有什么区别？
> - 表级锁：锁定整个表，即对整张表进行加锁。当一个事务对表进行读写操作时，会对整张表进行加锁，其他事务无法访问整个表。
> - 行级锁：锁定表中的一行，即对表中的某一行进行加锁。当一个事务对某一行进行读写操作时，会对该行进行加锁，其他事务可以访问表的其他行。
### 2.哪些操作会加表级锁？哪些操作会加⾏级锁？请简单举例说⼀下。
> 比如建表，主动锁表，truncate表时都会加表级锁
> 然后查询这些操作，如果走了索引就是行级锁，不是就是表级锁
### 3.InnoDB 有哪⼏类⾏锁？
> InnoDB 行锁是通过对索引数据页上的记录加锁实现的，MySQL InnoDB 支持三种行锁定方式：
> - 记录锁（Record Lock）：也被称为记录锁，属于单个行记录上的锁。
> - 间隙锁（Gap Lock）：锁定一个范围，不包括记录本身。
> - 临键锁（Next-Key Lock）：Record Lock+Gap Lock，锁定一个范围，包含记录本身，主要目的是为了解决幻读问题（MySQL 事务部分提到过）。记录锁只能锁住已经存在的记录，为了避免插入新记录，需要依赖间隙锁。
> 在 InnoDB 默认的隔离级别 REPEATABLE-READ 下，行锁默认使用的是 Next-Key Lock。但是，如果操作的索引是唯一索引或主键，InnoDB 会对 Next-Key Lock 进行优化，将其降级为 Record Lock，即仅锁住索引本身，而不是范围。
### 4.Next-Key Lock 的加锁范围？
> 加锁时，会先给表添加意向锁，IX 或 IS；
> 
> 加锁是如果是多个范围，是分开加了多个锁，每个范围都有锁；（这个可以实践下 id < 20 的情况）
> 
> 主键等值查询，数据存在时，会对该主键索引的值加行锁 X,REC_NOT_GAP；
> 
> 主键等值查询，数据不存在时，会对查询条件主键值所在的间隙添加间隙锁 X,GAP；
> 
> 主键等值查询，范围查询时情况则比较复杂：
### 5.当前读和快照读有什么区别？
> 快照读（一致性非锁定读）就是单纯的 SELECT 语句
> 
> 当前读 （一致性锁定读）就是给行记录加 X 锁或 S 锁。
### 6.MySQL 如何使⽤乐观锁和悲观锁？
> 在 MySQL 中，可以使用以下方式实现乐观锁：
> - 在表中增加一个版本号字段，每次更新记录时更新版本号。
> - 在更新记录时使用 `UPDATE` 语句并带上版本号的条件，如 `UPDATE table_name SET column1 = value1, version = new_version WHERE id = record_id AND version = old_version`。
> 
> 在 MySQL 中，可以通过在事务中使用 `SELECT ... FOR UPDATE` 或 `SELECT ... LOCK IN SHARE MODE` 来实现悲观锁，锁定待更新的数据，避免其他事务同时修改数据。